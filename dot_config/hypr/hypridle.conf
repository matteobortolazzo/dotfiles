general {
    lock_cmd = pidof hyprlock || hyprlock           # avoid starting multiple hyprlock instances.
    before_sleep_cmd = pidof hyprlock || hyprlock   # lock before suspend (direct, no loginctl dependency).
    after_sleep_cmd = ~/.config/hypr/scripts/resume.sh  # re-enable monitor, turn on display, restore brightness
}

# Dim monitor (battery — 5min)
listener {
    timeout = 300
    on-timeout = grep -q 0 /sys/class/power_supply/AC0/online 2>/dev/null && brightnessctl -s set 10
    on-resume = brightnessctl -r
}

# Dim monitor (AC — 10min)
listener {
    timeout = 600
    on-timeout = grep -q 1 /sys/class/power_supply/AC0/online 2>/dev/null && brightnessctl -s set 10
    on-resume = brightnessctl -r
}

# Turn off keyboard backlight
listener {
    timeout = 300                                          # 5min
    on-timeout = brightnessctl -sd rgb:kbd_backlight set 0
    on-resume = brightnessctl -rd rgb:kbd_backlight
}

# Lock screen
listener {
    timeout = 1200                                # 20min
    on-timeout = loginctl lock-session
}

# DPMS off
listener {
    timeout = 1800                                                   # 30min
    on-timeout = hyprctl dispatch dpms off
    on-resume = hyprctl dispatch dpms on && brightnessctl -r
}

# Suspend (battery only)
listener {
    timeout = 2700                                # 45min
    on-timeout = ~/.config/hypr/scripts/idle-suspend.sh
}
